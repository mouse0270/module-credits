/**
 * Minified by jsDelivr using Terser v5.7.1.
 * Original file: /npm/public-google-sheets-parser@1.2.6/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
 function asyncGeneratorStep(e,t,r,n,s,o,a){try{var i=e[o](a),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(n,s)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){asyncGeneratorStep(o,n,s,a,i,"next",e)}function i(e){asyncGeneratorStep(o,n,s,a,i,"throw",e)}a(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}const isBrowser="undefined"==typeof require,fetch=isBrowser?window.fetch:require("../src/fetch");let PublicGoogleSheetsParser=function(){function e(t,r){_classCallCheck(this,e),this.id=t,this.sheetName=r}var t;return _createClass(e,[{key:"getSpreadsheetDataUsingFetch",value:function(){if(!this.id)return null;let e=`https://docs.google.com/spreadsheets/d/${this.id}/gviz/tq?`;return this.sheetName&&(e=e.concat(`sheet=${this.sheetName}`)),fetch(e).then((e=>e&&e.ok&&e.text?e.text():null)).catch((e=>null))}},{key:"normalizeRow",value:function(e){return e.map((e=>e&&null!==e.v&&void 0!==e.v?e:{}))}},{key:"applyHeaderIntoRows",value:function(e,t){return t.map((({c:e})=>this.normalizeRow(e))).map((t=>t.reduce(((t,r,n)=>r.v?Object.assign(t,{[e[n]]:r.v}):t),{})))}},{key:"getItems",value:function(e){let t=[];try{const r=JSON.parse(e.split("\n")[1].replace(/google.visualization.Query.setResponse\(|\);/g,""));if(r.table.cols.some((({label:e})=>!!e))){const e=r.table.cols.map((({label:e})=>e));t=this.applyHeaderIntoRows(e,r.table.rows)}else{const[e,...n]=r.table.rows,s=this.normalizeRow(e.c).map((e=>e.v));t=this.applyHeaderIntoRows(s,n)}}catch(e){}return t}},{key:"parse",value:(t=_asyncToGenerator((function*(e,t){if(e&&(this.id=e),t&&(this.sheetName=t),!this.id)throw new Error("SpreadsheetId is required.");const r=yield this.getSpreadsheetDataUsingFetch();return null===r?[]:this.getItems(r)})),function(e,r){return t.apply(this,arguments)})}]),e}();isBrowser?window.PublicGoogleSheetsParser=PublicGoogleSheetsParser:(module.exports=PublicGoogleSheetsParser,module.exports.default=PublicGoogleSheetsParser);
 //# sourceMappingURL=public-google-sheets-parser.min.js.map